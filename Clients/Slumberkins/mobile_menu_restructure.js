var json = [{
    text: "Shop",
    link: "",
    subLinks: [{
        text: "Creatures",
        link: "",
        subLinks: [{
            "text": "Shop All",
            "link": "https://slumberkins.com/collections/all-topics"
        },
        {
            "text": "Alpaca",
            "link": "https://slumberkins.com/collections/stress-relief"
        },
        {
            "text": "Bigfoot",
            "link": "https://slumberkins.com/collections/self-esteem"
        },
        {
            "text": "Dragon",
            "link": "https://slumberkins.com/collections/creativity"
        },
        {
            "text": "Fox",
            "link": "https://slumberkins.com/collections/change"
        },
        {
            "text": "Hammerhead",
            "link": "https://slumberkins.com/collections/conflict-resolution"
        },
        {
            "text": "Honey Bear",
            "link": "https://slumberkins.com/collections/gratitude"
        },
        {
            "text": "Ibex",
            "link": "https://slumberkins.com/collections/emotional-courage"
        },
        {
            "text": "Lynx",
            "link": "https://slumberkins.com/collections/self-expression"
        },
        {
            "text": "Narwhal",
            "link": "https://slumberkins.com/collections/growth-mindset"
        },
        {
            "text": "Otter",
            "link": "https://slumberkins.com/collections/building-connections"
        },
        {
            "text": "Sloth",
            "link": "https://slumberkins.com/collections/routines"
        },
        {
            "text": "Sprite",
            "link": "https://slumberkins.com/collections/grief-and-loss"
        },
        {
            "text": "Unicorn",
            "link": "https://slumberkins.com/collections/authenticity"
        },
        {
            "text": "Yak",
            "link": "https://slumberkins.com/collections/self-acceptance"
        },
        {
            "text": "Yeti",
            "link": "https://slumberkins.com/collections/mindfulness"
        },
        {
            "text": "The Feels",
            "link": "https://slumberkins.com/collections/emotional-wellbeing"
        }
        ]

    }, {
        text: "Themes",
        link: "",
        subLinks: [{
            "text": "Shop All",
            "link": "https://slumberkins.com/collections"
        },
        {
            "text": "Authenticity",
            "link": "https://slumberkins.com/collections/authenticity"
        },
        {
            "text": "Building Connections",
            "link": "https://slumberkins.com/collections/building-connections"
        },
        {
            "text": "Change",
            "link": "https://slumberkins.com/collections/change"
        },
        {
            "text": "Conflict Resolution",
            "link": "https://slumberkins.com/collections/conflict-resolution"
        },
        {
            "text": "Creativity",
            "link": "https://slumberkins.com/collections/creativity"
        },
        {
            "text": "Emotional Courage",
            "link": "https://slumberkins.com/collections/emotional-courage"
        },
        {
            "text": "Emotional Well-Being",
            "link": "https://slumberkins.com/collections/emotional-wellbeing"
        },
        {
            "text": "Gratitude",
            "link": "https://slumberkins.com/collections/gratitude"
        },
        {
            "text": "Grief & Loss",
            "link": "https://slumberkins.com/collections/grief-and-loss"
        },
        {
            "text": "Growth Mindset",
            "link": "https://slumberkins.com/collections/growth-mindset"
        },
        {
            "text": "Mindfulness",
            "link": "https://slumberkins.com/collections/mindfulness"
        },
        {
            "text": "Routines",
            "link": "https://slumberkins.com/collections/routines"
        },
        {
            "text": "Self-Acceptance",
            "link": "https://slumberkins.com/collections/self-acceptance"
        },
        {
            "text": "Self-Esteem",
            "link": "https://slumberkins.com/collections/self-esteem"
        },
        {
            "text": "Self-Expression",
            "link": "https://slumberkins.com/collections/self-expression"
        },
        {
            "text": "Stress Relief",
            "link": "https://slumberkins.com/collections/stress-relief"
        }
        ]

    }, {
        text: "Product Types",
        link: "",
        subLinks: [{
            "text": "Shop All",
            "link": "https://slumberkins.com/collections/all-products"
        },
        {
            "text": "Kins",
            "link": "https://slumberkins.com/collections/kins"
        },
        {
            "text": "Snugglers",
            "link": "https://slumberkins.com/collections/snugglers"
        },
        {
            "text": "Books",
            "link": "https://slumberkins.com/collections/books"
        },
        {
            "text": "Minis",
            "link": "https://slumberkins.com/collections/minis"
        },
        {
            "text": "Sets",
            "link": "https://slumberkins.com/collections/sets"
        },
        {
            "text": "Extras",
            "link": "https://slumberkins.com/collections/extras"
        },
        {
            "text": "Educator Products",
            "link": "https://slumberkins.com/pages/hello-educators"
        },
        {
            "text": "Sale",
            "link": "https://slumberkins.com/collections/sale"
        },
        {
            "text": "Gift Card",
            "link": "https://slumberkins.com/products/gift-card"
        }
        ]
    },
    {
        text: "Limited Edition",
        link: "https://slumberkins.com/collections/limited-editions",
        subLinks: []
    },
    {
        text: "Book Club",
        link: "https://slumberkins.com/collections/book-club",
        subLinks: []
    },
    ]
}, {
    text: "About",
    link: "",
    subLinks: [{
        "text": "Our Crews",
        "link": "https://slumberkins.com/pages/skillbuilding-crews"
    },
    {
        "text": "Our Story",
        "link": "https://slumberkins.com/pages/about-us"
    },
    {
        "text": "Our Routine",
        "link": "https://slumberkins.com/pages/the-slumberkins-routine"
    },
    {
        "text": "Our Values",
        "link": "https://slumberkins.com/pages/our-values"
    }
    ]
},
{
    text: "Educators",
    link: "",
    subLinks: [{
        "text": "Shop All",
        "link": "https://slumberkins.com/collections/all-educator-products?tag=all"
    },
    {
        "text": "Educator Overview",
        "link": "https://slumberkins.com/pages/hello-educators"
    },
    {
        "text": "Curriculum Subscription",
        "link": "https://slumberkins.com/products/curriculum-hub-subscription"
    },
    {
        "text": "Unit Plans",
        "link": "https://slumberkins.com/collections/educator-unit-plans"
    },
    {
        "text": "Big Books",
        "link": "https://slumberkins.com/collections/educator-big-books"
    },
    {
        "text": "Kin + Big Book",
        "link": "https://slumberkins.com/collections/kin-big-book"
    }
    ]
},
{
    text: "Resources",
    link: "",
    subLinks: [{
        "text": "Downloadable Resources",
        "link": "https://slumberkins.com/pages/caregiver-resources"
    },
    {
        "text": "Caregiver Blog",
        "link": "https://slumberkins.com/blogs/slumberkins-blog"
    },
    {
        "text": "Slumberkins YouTube",
        "link": "https://www.youtube.com/slumberkins"
    },
    {
        "text": "Slumberkins Community",
        "link": "https://www.facebook.com/groups/slumberkinssocial/"
    }
    ]
}, {
    text: "Find The Perfect Creature Quiz",
    link: "https://slumberkins.com/pages/find-your-creature",
},
{
    text: "Get $10 Off",
    link: "https://slumberkins.com/pages/refer",
},

]

var mobileMenuInterval = setInterval(function () {
    var navItems = document.querySelectorAll('.mobile-nav > li')
    if (!navItems.length > 8) {
        return
    }
    clearInterval(mobileMenuInterval)
    var html = json.reduce(getSublinks, '')

    document.querySelector('.mobile-nav').innerHTML = html
    var toggles = document.querySelectorAll('.mobile-nav button')
    toggles.forEach(function (toggle, index) {
        var sibling = $(toggle).closest('.mobile-nav__item').next()
        var parent = $(toggle).closest('.mobile-nav__has-sublist')
        toggle.addEventListener('click', function () {
            if ($(parent).hasClass('mobile-nav--expanded')) {
                $(this).attr('aria-expanded', 'true')
                $(sibling).slideUp()
                $(parent).removeClass('mobile-nav--expanded')

            } else {
                $(this).attr('aria-expanded', 'false')
                $(sibling).slideDown()
                $(parent).addClass('mobile-nav--expanded')
            }
        })
        if (index == 0) {
            toggle.setAttribute('aria-expanded', 'true')
            $(sibling).slideDown()
            $(parent).addClass('mobile-nav--expanded')
        }
    })

    function getSublinks(totalHtml, item, index, array) {
        var topLinkHtml = ``
        // debugger
        if (item.subLinks) {
            if (item.subLinks.length > 0) {

                topLinkHtml =
                    `<li class="mobile-nav__item">
<div class="mobile-nav__has-sublist">
<a href="#" class="mobile-nav__link" id="Label-3">${item.text}</a>
<div class="mobile-nav__toggle">
    <button type="button" class="mobile-nav__toggle-btn icon-fallback-text" aria-controls="Linklist-3" aria-expanded="false">
    <span class="icon-fallback-text mobile-nav__toggle-open">
        <span class="icon icon-plus" aria-hidden="true"></span>
    </span>
    <span class="icon-fallback-text mobile-nav__toggle-close">
        <span class="icon icon-minus" aria-hidden="true"></span>
    </span>
    </button>
</div>
</div>
</li>
<ul class="mobile-nav__sublist" id="Linklist-3" aria-labelledby="Label-3" style="display: none;">
${item.subLinks.reduce(getSublinks, '')}
</ul>
`

            } else {
                topLinkHtml =
                    `<li class="mobile-nav__item">
                    <div class="mobile-nav__has-sublist">
                        <a href="${item.link}" class="mobile-nav__link" id="Label-3">${item.text}</a>
                    </div>
                </li>
                `
            }
        } else {
            topLinkHtml = `
<li class="mobile-nav__item">
    <a href="${item.link}" class="mobile-nav__link">
        ${item.text}
    </a>
</li>`
        }

        return totalHtml + topLinkHtml
    }

}, 250)